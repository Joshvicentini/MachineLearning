<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:f="http://java.sun.com/jsf/core"      
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
      
	<ui:composition template="/templates/template.xhtml">
      
    	<ui:define name="title">
    		<h:outputText value="#{msg['pagina.inicial.titulo']}"></h:outputText>
    	</ui:define>
    	
    	<ui:define name="content">
    	<h:form>
    		<div class="superiorPanel">
	    		<p:toolbar>
	    			<p:toolbarGroup align="left">
	    				<h:panelGrid columns="3" cellpadding="5">
				    		<p:selectOneMenu value="#{mainBean.selectedMethod}">
				    			<f:selectItems value="#{autocompleteBean.listMethods}" />
				    		</p:selectOneMenu>
				    		<p:selectOneMenu value="#{mainBean.selectedParameter}">
				    			<f:selectItem itemLabel="Dados do RU" itemValue="1" />
				    		</p:selectOneMenu>
				    		<p:commandButton value="Run" action="#{mainBean.execute}" icon="ui-icon-circle-triangle-e" update="chartPanel"/>
	    				</h:panelGrid>
	    			</p:toolbarGroup>
	    		</p:toolbar>
    		</div>
    		<div class="leftPanel">
    			<p:panel header="Data" styleClass="panel">
    				<center style="border-bottom:1px solid #CDCDCD;margin-bottom: 10px;">
	    				<p:commandButton value="Load File" type="button" onclick="fileDialog.show();" icon="ui-icon-arrowthickstop-1-n" style="margin:10px 0;"/>
    				</center>
    				<p:dataTable value="#{mainBean.listDataModel}"
    					var="fileData"
    					rowKey="#{fileData.id}"
    					editable="true"
    					emptyMessage="No data loaded.">
    					
    					<f:facet name="header">
    						<h:outputText value="#{mainBean.file == null ? 'File' : mainBean.fileNameTruncated}"/>
    					</f:facet>
    					
    					<p:column headerText="#{mainBean.nameColumn1 == null || mainBean.nameColumn1.equals('') ? 'Value 1' : mainBean.nameColumn1}" style="width:50%;">
    						<p:cellEditor>
    							<f:facet name="output">
		    						<h:outputText value="#{fileData.value1}" />
    							</f:facet>
    							<f:facet name="input">
		    						<p:inputText value="#{fileData.value1}" style="width:100%;" />
    							</f:facet>
    						</p:cellEditor>
    					</p:column>
    					
    					<p:column headerText="#{mainBean.nameColumn2 == null || mainBean.nameColumn2.equals('') ? 'Value 2' : mainBean.nameColumn2}" style="width:50%;">
    						<p:cellEditor>
    							<f:facet name="output">
		    						<h:outputText value="#{fileData.value2}" />
    							</f:facet>
    							<f:facet name="input">
		    						<p:inputText value="#{fileData.value2}" style="width:100%;" />
    							</f:facet>
    						</p:cellEditor>
    					</p:column>
    					
    					<p:column>
    						<p:rowEditor />
    					</p:column>
    					
    					
    					<p:ajax event="rowEdit" update="@this" ></p:ajax>
    				</p:dataTable>
    			</p:panel>
    		</div>
    		<div class="rightPanel">
    			<p:panel id="chartPanel" header="Chart" styleClass="panel">
    				<p:outputPanel rendered="#{mainBean.showChart}">
		    			<div>
		    				<p:selectOneButton value="#{mainBean.selectedChartType}">
		    					<p:ajax event="change" update="chartPanel" />
		    					<f:selectItem itemLabel="Bar" itemValue="0" />
		    					<f:selectItem itemLabel="Line" itemValue="1" />
		    				</p:selectOneButton>
		    			</div>
	    				<p:barChart id="barChart" value="#{mainBean.chartModel}" zoom="true" title="Bar Chart" rendered="#{mainBean.selectedChartType == 0}" />
	    				<p:lineChart id="lineChart" value="#{mainBean.chartModel}" zoom="true" title="Linear Chart" rendered="#{mainBean.selectedChartType == 1}" />
    				</p:outputPanel>
    			</p:panel>
    		</div>
    		<div class="clear"/>
    	</h:form>
    	</ui:define>
    	
    	<ui:define name="dialogs">
			<p:dialog header="Load File" widgetVar="fileDialog" resizable="false" draggable="false" modal="true" footer="Somente arquivos .csv">
		    	<h:form enctype="multipart/form-data">  
		    		<h:panelGrid columns="2">
		    			<p:panelGrid columns="2">
			    			<h:outputText value="File with header: " />
			    			<p:selectBooleanButton offLabel="No" onLabel="Yes" value="#{mainBean.hasHeader}" />
			    			<h:outputText value="File separator: " />
			    			<p:inputText value="#{mainBean.fileSeparator}" style="width:40px;" />
						    <p:fileUpload value="#{mainBean.file}" mode="simple" />
						    <p:commandButton value="Ok" ajax="false" icon="ui-icon-check" action="#{mainBean.loadFile}" />  
		    			</p:panelGrid>
		    		</h:panelGrid>
				</h:form>  
			</p:dialog>    	
    	</ui:define>
    	      
    </ui:composition>
      
</html>